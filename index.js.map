{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import { getApiKey } from './crypto';\nimport axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api';\n\nexport async function getImagesAxios(searchTerm, page = 1, itemsPerPage = 15) {\n  try {\n    const response = await axios.get('/', {\n      params: {\n        key: getApiKey(),\n        q: searchTerm,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: itemsPerPage,\n        page: page,\n      },\n    });\n    return response.data;\n  } catch (error) {\n    console.error('Error fetching photos:', error);\n    throw error;\n  }\n}\n","import iziToast from 'izitoast';\n// Додатковий імпорт стилів\nimport 'izitoast/dist/css/iziToast.min.css';\n\nfunction getItemMarkdown(item) {\n  // webformatURL — посилання на маленьке зображення для списку карток у галереї\n  // largeImageURL — посилання на велике зображення для модального вікна\n  // tags — рядок з описом зображення. Підійде для атрибута alt\n  // likes — кількість вподобайок\n  // views — кількість переглядів\n  // comments — кількість коментарів\n  // downloads — кількість завантажень\n  return `\n  <li class=\"gallery-item\">\n    <a href=\"${item.largeImageURL}\"\n      class=\"galery-item-image-link\">\n      <img class=\"galery-item-image\"\n        src=\"${item.webformatURL}\"\n        alt=\"${item.tags}\" />\n    </a>\n    <ul class=\"image-info\">\n      <li class=\"image-info-item\">\n        <p class=\"info-item-caption\">Likes</p>\n        <p class=\"info-item-value\">${item.likes}</p>\n      </li>\n      <li class=\"image-info-item\">\n        <p class=\"info-item-caption\">Views</p>\n        <p class=\"info-item-value\">${item.views}</p>\n\n      </li>\n      <li class=\"image-info-item\">\n        <p class=\"info-item-caption\">Comments</p>\n        <p class=\"info-item-value\">${item.comments}</p>\n      </li>\n      <li class=\"image-info-item\">\n        <p class=\"info-item-caption\">Downloads</p>\n        <p class=\"info-item-value\">${item.downloads}</p>\n      </li>\n    </ul>\n  </li>\n`;\n}\n\nexport function getGalleryMarkdown(images) {\n  return images.map(getItemMarkdown).join('');\n}\n\n/**\n * @param {Object} gallery gallery DOM object\n * @param {String} markdown HTML markdown for gallery\n * @param {String} mode:\n *                      full (default) - replace with InnerHTML\n *                      beforebegin, afterbegin, beforeend, afterend - insert with insertAdjacentHTML\n */\nexport function drawGallery(gallery, markdown, mode = 'full') {\n  switch (mode) {\n    case 'full':\n      gallery.innerHTML = markdown;\n      break;\n\n    default:\n      gallery.insertAdjacentHTML(mode, markdown);\n      break;\n  }\n}\n\nconst iziCommon = {\n  message: 'Common message',\n  theme: 'dark',\n  position: 'topRight',\n  titleColor: '#fff',\n  titleSize: '16px',\n  titleLineHeight: '1.5',\n  messageColor: '#fff',\n  messageSize: '16px',\n  messageLineHeight: '1.5',\n  imageWidth: 24,\n};\n\nconst notifications = {\n  success: {\n    ...iziCommon,\n    //title: 'OK',\n    color: '#59a10d',\n    iconUrl: 'ok-icon.svg',\n  },\n  error: {\n    ...iziCommon,\n    //title: 'Error',\n    color: '#ef4040',\n    iconUrl: 'error-icon.svg',\n  },\n  warning: {\n    ...iziCommon,\n    //title: 'Warning',\n    color: '#ffa000',\n    iconUrl: 'caution-icon.svg',\n  },\n};\n\nexport function messageWarning(message) {\n  iziToast.warning({\n    ...notifications.warning,\n    message: message,\n  });\n}\n\nexport function messageError(message) {\n  iziToast.error({\n    ...notifications.error,\n    message: message,\n  });\n}\n\nexport function showHtmlObject(htmlObject) {\n  htmlObject.classList.remove('visually-hidden');\n}\n\nexport function hideHtmlObject(htmlObject) {\n  htmlObject.classList.add('visually-hidden');\n}\n","import { getImagesAxios } from './js/pixabay-api';\nimport {\n  getGalleryMarkdown,\n  drawGallery,\n  messageWarning,\n  messageError,\n  showHtmlObject,\n  hideHtmlObject,\n} from './js/render-functions';\nimport SimpleLightbox from 'simplelightbox';\n// Додатковий імпорт стилів\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst refs = {\n  loader: document.querySelector('.js-loader'),\n};\n\nconst myGallery = document.querySelector('.gallery');\nconst searchButton = document.querySelector('.search-button');\nconst searchInput = document.querySelector('.search-input');\nconst loadMoreButton = document.querySelector('.load-more-button');\n\nconst simpleLightBox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n  overlayOpacity: 0.8,\n});\n\nconst minSearchTermLength = 2;\nlet page = 1;\nlet searchTermGlobal = '';\nlet perPage = 15; // items per page\nlet totalHits = 0;\n\nsearchButton.addEventListener('click', searchButtonHandler);\nloadMoreButton.addEventListener('click', loadMoreButtonHandler);\n\nasync function searchButtonHandler(event) {\n  event.preventDefault();\n  let searchTerm = String(searchInput.value.trim());\n  searchTerm = searchTerm.replace(/[*]/g, ''); // видалення спецсимволів\n  let galleryMarkdown = '';\n  let images = '';\n\n  if (!searchTerm || searchTerm.length < minSearchTermLength) {\n    messageWarning(\n      `Enter data for search, please. Min. ${minSearchTermLength} symbols.`\n    );\n    searchInput.value = ''; // clear input\n    drawGallery(myGallery, ''); // clear gallery\n    hideHtmlObject(loadMoreButton);\n    return;\n  }\n\n  refs.loader.classList.add('is-active');\n  drawGallery(myGallery, ''); // clear gallery\n  hideHtmlObject(loadMoreButton);\n\n  searchTermGlobal = searchTerm; // save searchTerm in global variable;\n  page = 1;\n\n  images = await getImagesAxios(searchTerm, page, perPage);\n\n  totalHits = images.totalHits;\n  if (images.hits.length === 0) {\n    messageError(\n      'Sorry, there are no images matching<br> your search query. Please, try again!'\n    );\n    searchInput.value = ''; // clear input\n    refs.loader.classList.remove('is-active');\n    drawGallery(myGallery, ''); // clear gallery\n  } else {\n    searchInput.value = ''; // clear input\n\n    galleryMarkdown = getGalleryMarkdown(images.hits);\n\n    refs.loader.classList.remove('is-active');\n    drawGallery(myGallery, galleryMarkdown);\n\n    simpleLightBox.refresh();\n\n    if (totalHits > page * perPage) {\n      showHtmlObject(loadMoreButton);\n    } else {\n      messageWarning(\n        \"We're sorry, but you've reached<br>the end of search results.\"\n      );\n      hideHtmlObject(loadMoreButton);\n    }\n  }\n}\n\nasync function loadMoreButtonHandler(event) {\n  event.preventDefault();\n  page += 1;\n  let galleryMarkdown = '';\n  let images = '';\n\n  refs.loader.classList.add('is-active');\n  hideHtmlObject(loadMoreButton);\n\n  images = await getImagesAxios(searchTermGlobal, page, perPage); // використовуємо глобальний searchTerm\n\n  totalHits = images.totalHits;\n  if (images.hits.length === 0) {\n    // тут вже не перша сторінка і якщо результат пошуку пустий то більше зображень нема\n    messageError(\n      \"We're sorry, but you've reached<br>the end of search results.\"\n    );\n  } else {\n    galleryMarkdown = getGalleryMarkdown(images.hits);\n    drawGallery(myGallery, galleryMarkdown, 'beforeend'); // додаємо зображення на екран\n    simpleLightBox.refresh();\n    // scroll\n    const galleryItem = document.querySelector('.gallery-item');\n    window.scrollBy({\n      top: galleryItem.getBoundingClientRect().height * 2,\n      left: 0,\n      behavior: 'smooth',\n    });\n\n    if (totalHits > page * perPage) {\n      showHtmlObject(loadMoreButton);\n    } else {\n      messageWarning(\n        \"We're sorry, but you've reached<br>the end of search results.\"\n      );\n      hideHtmlObject(loadMoreButton);\n    }\n  }\n  refs.loader.classList.remove('is-active');\n}\n\n// обробка інших помилок\nwindow.onerror = (message, source, lineno, colno, error) => {\n  // Обробляємо всі необроблені помилки\n  console.error('Unhandled error:', error);\n};\n"],"names":["axios","getImagesAxios","searchTerm","page","itemsPerPage","getApiKey","error","getItemMarkdown","item","getGalleryMarkdown","images","drawGallery","gallery","markdown","mode","iziCommon","notifications","messageWarning","message","iziToast","messageError","showHtmlObject","htmlObject","hideHtmlObject","refs","myGallery","searchButton","searchInput","loadMoreButton","simpleLightBox","SimpleLightbox","minSearchTermLength","searchTermGlobal","perPage","totalHits","searchButtonHandler","loadMoreButtonHandler","event","galleryMarkdown","galleryItem","source","lineno","colno"],"mappings":"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"}